# **Summer Framework - 开发计划**

**版本历史**

| 版本 | 日期       | 作者      | 变更说明             |
| ---- | ---------- | --------- | -------------------- |
| 1.0  | 2025-05-03 | FaustoFan | 基于 SRS 和 ODD 创建 |
| 1.1  | YYYY-MM-DD | (待定)    | (根据实际情况调整)   |

---

**目录**

1. [引言](#1-引言)
   1.1 [目的](#11-目的)
   1.2 [范围](#12-范围)
   1.3 [假设](#13-假设)
2. [开发阶段与里程碑](#2-开发阶段与里程碑)
3. [详细任务分解](#3-详细任务分解)
   3.1 [阶段 0: 基础架构与核心设置 (Foundation &amp; Core Setup)](#31-阶段-0-基础架构与核心设置-foundation--core-setup)
   3.2 [阶段 1: 核心 Web 与 IOC (Core Web &amp; IOC)](#32-阶段-1-核心-web-与-ioc-core-web--ioc)
   3.3 [阶段 2: 功能增强 (Feature Enrichment)](#33-阶段-2-功能增强-feature-enrichment)
   3.4 [阶段 3: Starters 与生态系统 (Starters &amp; Ecosystem)](#34-阶段-3-starters-与生态系统-starters--ecosystem)
   3.5 [阶段 4: 稳定化与发布准备 (Stabilization &amp; Release Prep)](#35-阶段-4-稳定化与发布准备-stabilization--release-prep)
   3.6 [阶段 5: 首个正式版发布与维护 (v1.0 Release &amp; Maintenance)](#36-阶段-5-首个正式版发布与维护-v10-release--maintenance)
4. [时间线估算 (占位)](#4-时间线估算-占位)
5. [资源需求 (概念)](#5-资源需求-概念)
6. [风险管理](#6-风险管理)
7. [测试策略](#7-测试策略)
8. [文档计划](#8-文档计划)
9. [发布策略](#9-发布策略)

---

## 1. 引言

### 1.1 目的

本文档旨在规划 Summer Framework 的开发过程，明确开发阶段、关键里程碑、任务分解、时间估算、资源需求和相关策略，以指导项目从启动到首个正式版本的发布。

### 1.2 范围

本计划涵盖了 SRS 中定义的所有功能和非功能性需求的实现，以及 ODD 中描述的核心组件设计。范围包括核心框架开发、必要的测试、文档编写和发布准备。

### 1.3 假设

- **团队:** 假设有一个小到中型的专职开发团队（至少 2-3 名熟悉 Rust 和 Web 框架概念的开发者）。
- **资源:** 假设具备必要的开发工具、硬件资源和协作平台。
- **优先级:** 计划中的任务优先级可能根据开发过程中的反馈和挑战进行调整。
- **时间估算:** 所有时间均为初步估算，实际时间可能因具体实现难度、技术挑战和资源可用性而变化。

---

## 2. 开发阶段与里程碑

| 阶段 | 名称                 | 主要目标                                                    | 关键里程碑 (Milestone)                                         |
| :--- | :------------------- | :---------------------------------------------------------- | :------------------------------------------------------------- |
| 0    | 基础架构与核心设置   | 搭建项目结构、CI/CD、集成核心库、建立日志和配置基础         | **M0:** 项目可编译，CI 通过，日志和基础配置可工作              |
| 1    | 核心 Web 与 IOC      | 实现基础 HTTP 服务、MVC 路由、编译时 IOC 容器、核心注解处理 | **M1:** 可处理简单 HTTP 请求 ("Hello World")，IOC 完成核心功能 |
| 2    | 功能增强             | 实现高级 MVC 功能、AOP 核心、自动配置基础                   | **M2:** AOP 可用 (基本通知)，自动配置框架搭建完成              |
| 3    | Starters 与生态系统  | 开发核心 Starters (Web, DB, Cache)、完善中间件和插件机制    | **M3:** Web/SQLx/Redis Starter 可用，中间件/插件机制成熟       |
| 4    | 稳定化与发布准备     | 全面测试、性能优化、API 审查、文档完善、安全审计            | **M4:** Beta 版本发布，文档基本完成，性能达标                  |
| 5    | 首个正式版发布与维护 | 发布 v1.0.0，收集反馈，修复 Bug，规划后续版本               | **M5:** v1.0.0 正式发布到 Crates.io                            |

---

## 3. 详细任务分解

### 3.1 阶段 0: 基础架构与核心设置 (Foundation & Core Setup)

- **任务:**
  - [T0.1] 创建项目结构 (Workspace, Core Crates)
  - [T0.2] 配置 Git 仓库和版本控制策略
  - [T0.3] 搭建基础 CI/CD 流程 (Linting, Basic Tests, Build)
  - [T0.4] 集成 `tracing` 并实现基础日志配置 (F8)
  - [T0.5] 集成 `config-rs` 并实现基础配置加载逻辑 (F4)
  - [T0.6] 集成 `serde`
  - [T0.7] 搭建 IOC 容器的基础框架（接口定义，核心数据结构）(F3)
  - [T0.8] 定义核心错误类型 (`Error`, `Result`)
  - [T0.9] 编写基础单元测试

### 3.2 阶段 1: 核心 Web 与 IOC (Core Web & IOC)

- **任务:**
  - [T1.1] 实现基于 `hyper` 的基础 HTTP Server 启动/关闭 (F1)
  - [T1.2] 封装基础 Request/Response 对象
  - [T1.3] 设计并实现核心注解的 Proc-Macro (`@Component`, `@Service`, `@Controller`, `@Autowired`, `@Value` 基础) (F7)
  - [T1.4] 实现 IOC 容器的编译时组件扫描与注册 (F3)
  - [T1.5] 实现 IOC 容器的构造函数注入和字段注入 (F3)
  - [T1.6] 实现 IOC 容器的 Bean 获取 API
  - [T1.7] 设计并实现 MVC 路由注解 (`@GetMapping`, `@PostMapping` 等) (F7)
  - [T1.8] 实现基于 Proc-Macro 的静态路由表生成与运行时匹配 (F2)
  - [T1.9] 将 HTTP Server 请求分发到 MVC 路由
  - [T1.10] 实现简单的 Controller 方法调用和文本响应返回 (F2)
  - [T1.11] 实现 `@Value` 注入基础配置 (F4)
  - [T1.12] 编写 IOC 和 MVC 核心的集成测试

### 3.3 阶段 2: 功能增强 (Feature Enrichment)

- **任务:**
  - [T2.1] 实现 MVC 请求参数绑定 (路径变量, 查询参数, 请求头) (F2) - `@PathVariable`, `@RequestParam`, `@RequestHeader` 宏 (F7)
  - [T2.2] 实现 MVC 请求体反序列化 (JSON, Form) (F2) - `@RequestBody` 宏 (F7)
  - [T2.3] 实现 MVC 响应自动序列化 (JSON) 和 `impl IntoResponse` 支持 (F2)
  - [T2.4] 实现统一错误处理机制 (`Result<T, E>` 映射, `@ExceptionHandler` 基础) (F2)
  - [T2.5] 设计并实现 AOP 核心注解 (`@Aspect`, `@Pointcut`, `@Before`, `@AfterReturning` 等) (F7)
  - [T2.6] 实现基于 Proc-Macro 的编译时 AOP 织入 (针对 IOC Bean) (F6)
  - [T2.7] 实现 `JoinPoint` 上下文传递
  - [T2.8] 设计并实现自动配置基础注解 (`@Configuration`, `@Bean`, `@Conditional...` 基础) (F7)
  - [T2.9] 搭建自动配置加载和条件评估框架 (F5)
  - [T2.10] 实现 IOC 生命周期回调 (`@PostConstruct`, `@PreDestroy`) (F3)
  - [T2.11] 实现 `@ConfigurationProperties` (F4)
  - [T2.12] 增强日志上下文关联 (Trace ID) (F8)
  - [T2.13] 编写 AOP 和自动配置的测试用例

### 3.4 阶段 3: Starters 与生态系统 (Starters & Ecosystem)

- **任务:**
  - [T3.1] 设计并实现 Web 中间件 API 和注册机制 (F9)
  - [T3.2] 设计并实现插件 API (`Plugin` trait) 和生命周期管理 (F9)
  - [T3.3] 开发 `summer-starter-web`: 包含 Web Server, MVC, 常用中间件 (如日志) 的自动配置 (F5)
  - [T3.4] 开发 `summer-starter-sqlx`: 集成 SQLx，自动配置 DataSource 和 Pool (F5, F9)
  - [T3.5] 开发 `summer-starter-redis` (或类似缓存): 自动配置缓存客户端 (F5, F9)
  - [T3.6] (可选) 开发其他 Starter (e.g., RocketMQ, Kafka)
  - [T3.7] 完善自动配置的条件注解实现 (`@Conditional...`) (F5)
  - [T3.8] 实现 HTTPS/TLS 支持 (F1)
  - [T3.9] 编写 Starters 和插件/中间件的集成测试

### 3.5 阶段 4: 稳定化与发布准备 (Stabilization & Release Prep)

- **任务:**
  - [T4.1] **全面测试:**
    - 增加单元测试覆盖率
    - 编写更复杂的集成测试场景
    - 开发端到端 (E2E) 测试用例
  - [T4.2] **API 审查与稳定:** 审查所有公开 API (注解, trait, 函数)，确保一致性和易用性，标记不稳定 API。
  - [T4.3] **性能测试与优化:**
    - 建立基准测试 (Benchmarks) (FNon-Perf)
    - 识别并解决性能瓶颈 (异步调度, 内存分配, 锁竞争等)
  - [T4.4] **文档完善:** (见 [文档计划](#8-文档计划))
    - 编写用户指南、教程
    - 完善 API 文档 (rustdoc)
  - [T4.5] **安全性:**
    - 运行 `cargo audit` 并修复已知漏洞
    - 代码审查，关注安全隐患 (如输入处理、依赖注入安全) (FNon-Sec)
  - [T4.6] **示例项目:** 创建 1-2 个展示核心功能的示例项目。
  - [T4.7] **准备 Beta 版本发布:** 打包、测试、发布说明。

### 3.6 阶段 5: 首个正式版发布与维护 (v1.0 Release & Maintenance)

- **任务:**
  - [T5.1] 处理 Beta 版本反馈，修复关键 Bug。
  - [T5.2] 完成 v1.0.0 的最终测试和文档。
  - [T5.3] 编写 v1.0.0 发行说明 (Release Notes)。
  - [T5.4] **正式发布:** 将核心库和 Starters 发布到 Crates.io。
  - [T5.5] **社区支持:** 建立 Github Discussions 或其他渠道，响应用户问题和反馈。
  - [T5.6] **维护:** 修复后续发现的 Bug，发布 Patch 版本。
  - [T5.7] **规划:** 根据反馈和社区需求，规划 v1.1 或 v2.0 的功能。

---

## 4. 时间线估算 (占位)

**免责声明:** 以下时间为**高度简化**的估算，假设有 2-3 名全职经验丰富的 Rust 开发者，并且技术攻关顺利。实际时间可能需要根据具体情况调整。

| 阶段 | 名称                 | 估算时长 (周) | 累计时长 (周) |
| :--- | :------------------- | :------------ | :------------ |
| 0    | 基础架构与核心设置   | 2 - 3         | 2 - 3         |
| 1    | 核心 Web 与 IOC      | 4 - 6         | 6 - 9         |
| 2    | 功能增强             | 5 - 7         | 11 - 16       |
| 3    | Starters 与生态系统  | 4 - 6         | 15 - 22       |
| 4    | 稳定化与发布准备     | 4 - 6         | 19 - 28       |
| 5    | 首个正式版发布与维护 | (持续)        | > 28          |

**总计 (至 v1.0): 约 5 - 7 个月**

**(建议使用项目管理工具如 Jira, Trello, 或 Github Projects 跟踪具体任务进度)**

---

## 5. 资源需求 (概念)

- **人员:**
  - Rust 开发工程师 (核心框架，熟悉异步、宏、Web): 2-3+ 名
  - (可选) 构建/CI/CD 专家: 1 名 (可由开发者兼任)
  - (可选) 技术文档编写者: 1 名 (可由开发者兼任)
  - (可选) QA/测试工程师: 1 名 (初期可由开发者承担)
  - 项目负责人/经理: 1 名
- **工具:**
  - 代码托管: Git (Github, Gitlab 等)
  - 项目管理: Jira, Trello, Github Projects 等
  - CI/CD: Github Actions, Gitlab CI, Jenkins 等
  - 协作沟通: Slack, Discord, Teams 等
  - 开发环境: Rust 工具链, IDE (VSCode with rust-analyzer, CLion with Rust plugin)

---

## 6. 风险管理

参考 SRS 和 ODD 中的风险分析，持续跟踪和应对：

- **学习曲线:** 提供内部培训/分享，代码配对，鼓励参与社区。
- **宏复杂性:** 严格的代码审查，模块化宏设计，充分测试。
- **生态不成熟/AOP 难度:** 分阶段实现，优先核心功能，对复杂特性预留研究时间。
- **性能:** 尽早建立基准测试，持续性能分析。
- **依赖兼容性:** 定期、谨慎地更新依赖，加强 CI 测试覆盖。

---

## 7. 测试策略

- **单元测试:** 使用 Rust 内置测试框架 (`#[test]`)，覆盖核心逻辑、工具函数、宏的输出。
- **集成测试:** 测试模块间的交互（如 IOC 与 MVC，AOP 与 IOC），API 调用。放在 `tests` 目录下。
- **端到端 (E2E) 测试:** 启动完整的 Summer 应用实例，使用 HTTP 客户端 (如 `reqwest`) 发送真实请求，验证响应。覆盖典型用户场景。
- **宏测试:** 使用 `trybuild` 或类似库测试过程宏的编译成功/失败情况和生成的代码。
- **性能测试:** 使用 `criterion` 或类似库建立基准测试，监控关键路径性能。
- **代码覆盖率:** 使用 `cargo-tarpaulin` 等工具跟踪测试覆盖率，目标 > 80%。
- **CI 集成:** 所有测试类型都应集成到 CI 流程中。

---

## 8. 文档计划

- **目标受众:** Rust 开发者 (有或无 Spring 背景)。
- **主要内容:**
  - **README:** 项目概述、快速开始、安装。
  - **用户指南:**
    - 核心概念 (IOC, MVC, AOP, Config, AutoConf)
    - 入门教程 (创建第一个 Summer 应用)
    - 详细功能说明 (各模块、注解用法)
    - 集成示例 (数据库、缓存等)
    - 部署指南
  - **API 参考文档:** 使用 `rustdoc` 从代码注释自动生成，确保公共 API 有详细文档。
  - **示例项目:** 提供可运行的示例代码库。
  - **贡献指南:** 如何参与开发、报告问题、代码风格。
- **时间:** 文档编写贯穿整个开发过程，在阶段 4 集中完善和审查。

---

## 9. 发布策略

- **版本控制:** 遵循语义化版本控制 (Semantic Versioning 2.0.0)。
- **发布节奏:**
  - 早期开发阶段：不定期发布 Alpha 版本 (e.g., `0.1.0-alpha.1`) 用于内部测试或早期尝鲜。
  - 阶段 4 结束：发布 Beta 版本 (e.g., `1.0.0-beta.1`)，公开征集测试和反馈。
  - 阶段 5 结束：发布第一个稳定版 `1.0.0`。
  - 后续：根据 Bug 修复发布 Patch 版本 (1.0.x)，根据新功能（向后兼容）发布 Minor 版本 (1.x.0)，重大变更发布 Major 版本 (x.0.0)。
- **发布渠道:** 主要发布到 [crates.io](https://crates.io/)。
- **发布说明:** 每个版本发布时提供清晰的变更日志 (Changelog)。

---
